<include file="Public/header"/>
	<!--//////////////////////////////////////////////////-->
	<!--///////////////////Cart Page//////////////////////-->
	<!--//////////////////////////////////////////////////-->
	<div id="page-content" class="single-page">
		<div class="container">
			<div class="row">
				<div class="col-lg-12">
					<ul class="breadcrumb">
						<li><a href="/">首页</a></li>
						<li>购物车</li>
					</ul>
				</div>
			</div>
			<volist name="cartGoods" id="goods">
				<div class="row">
					<div class="product well">
						<div class="col-md-3">
							<div class="image">
								<img src="{$goods.goods_img}" />
							</div>
						</div>
						<div class="col-md-9">
							<div class="caption">
								<div class="name"><h3><a href="/home/index/product/id/{$goods.goods_id}.html">{$goods.goods_name}</a></h3></div>
								<div class="info">
									<ul>
										<li>品牌: {$goods.brand}</li>
										<li>编号: {$goods.goods_id}</li>
									</ul>
								</div>
								<div class="price">{$goods.promote_price}<span>{$goods.shop_price}</span></div>
								<label>数量: </label>
								<input class="form-inline quantity" type="text" value="{$goods.count}">
								<a href="javascript:void(0);" onclick="updateCount(this, {$goods.goods_id})" class="btn btn-2 ">更新</a>
								<hr>
								<a href="#" class="btn btn-default pull-right">删除</a>
							</div>
						</div>
						<div class="clear"></div>
					</div>
				</div>
			</volist>
			<div class="row">
				<div class="col-md-4 col-md-offset-8 ">
					<center><a href="#" class="btn btn-1">继续购物</a></center>
				</div>
			</div>
			<div class="row">
				<div class="pricedetails">
					<div class="col-md-4 col-md-offset-8">
						<table>
							<h6>购物车</h6>
							<tr>
								<td>商品总计</td>
								<td id="goods_count">{$gsprice}</td>
							</tr>
							<tr>
								<td>优惠</td>
								<td id="goods_yh">{$gpprice}</td>
							</tr>
							<tr>
								<td>运费</td>
								<td>0.00</td>
							</tr>
							<tr style="border-top: 1px solid #333">
								<td><h5>总计</h5></td>
								<td id="all_count">{$allCount}</td>
							</tr>
						</table>
						<center><a href="#" class="btn btn-1">结账</a></center>
					</div>
				</div>
			</div>
		</div>
	</div>	
	<include file="Public/footer"/>
<script>
	function updateCount(obj, gid){
		var cou = $(obj).prev('input').val();
		if(isNaN(cou) || cou < 1){
			alert("请输入大于0的整数！");
			return;
		}

		$.ajax({
			url: '/home/goods/updateCount',
			data: {gid: gid, cou: cou},
			type: 'post',
			dataType: 'json',
			success: function(data){
				if(data.state == 1)
				{
					$('#goods_count').text(data.gsprice);
					$('#goods_yh').text(data.gpprice);
					$('#all_count').text(data.allCount);

					alert('更新成功！');
				}
			}
		});
	}
</script>
</body>
</html>
